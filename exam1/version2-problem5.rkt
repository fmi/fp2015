#lang racket

(require rackunit)
(require rackunit/text-ui)

(define (all-prods ns)
  (define (helper ns index prod)
    (cond
      [(= index (length ns))
       (list prod)]
      [else (append (helper ns (add1 index) (* prod (list-ref ns index)))
                    (helper ns (add1 index) prod))]))
  (cond
    [(equal? (remove-duplicates ns) '(0)) '(0)]
    [else (remove-duplicates (rest (sort (helper ns 0 1) <)))]))


(define (sort-and-dedup answer)
  (sort (remove-duplicates answer) <))

(run-tests
 (test-suite
  "Running tests for 5th problem - all products"
  (check-equal? (sort-and-dedup (all-prods '(1 2 3))) '(1 2 3 6) "Example from exam")
  (check-equal? (sort-and-dedup (all-prods '(0 1 2))) '(0 1 2) "Example from exam")
  (check-equal? (sort-and-dedup (all-prods '(3 7 9))) '(3 7 9 21 27 63 189))
  (check-equal? (sort-and-dedup (all-prods '(1))) '(1) "All possible sums from 1")
  (check-equal? (sort-and-dedup (all-prods '(0))) '(0) "All products from 0 are 0")
  (check-equal? (sort-and-dedup (all-prods '(1 2 3 4 5 6 7 8 9 10)))
                '(1
                  2
                  3
                  4
                  5
                  6
                  7
                  8
                  9
                  10
                  12
                  14
                  15
                  16
                  18
                  20
                  21
                  24
                  27
                  28
                  30
                  32
                  35
                  36
                  40
                  42
                  45
                  48
                  50
                  54
                  56
                  60
                  63
                  64
                  70
                  72
                  80
                  84
                  90
                  96
                  100
                  105
                  108
                  112
                  120
                  126
                  135
                  140
                  144
                  150
                  160
                  162
                  168
                  180
                  189
                  192
                  200
                  210
                  216
                  224
                  240
                  252
                  270
                  280
                  288
                  300
                  315
                  320
                  324
                  336
                  350
                  360
                  378
                  384
                  400
                  420
                  432
                  448
                  450
                  480
                  504
                  540
                  560
                  576
                  600
                  630
                  640
                  648
                  672
                  700
                  720
                  756
                  800
                  810
                  840
                  864
                  900
                  945
                  960
                  1008
                  1050
                  1080
                  1120
                  1134
                  1152
                  1200
                  1260
                  1296
                  1344
                  1350
                  1400
                  1440
                  1512
                  1600
                  1620
                  1680
                  1728
                  1800
                  1890
                  1920
                  2016
                  2100
                  2160
                  2240
                  2268
                  2400
                  2520
                  2592
                  2688
                  2700
                  2800
                  2880
                  3024
                  3150
                  3200
                  3240
                  3360
                  3456
                  3600
                  3780
                  3840
                  4032
                  4200
                  4320
                  4480
                  4536
                  4800
                  5040
                  5184
                  5400
                  5600
                  5670
                  5760
                  6048
                  6300
                  6480
                  6720
                  7200
                  7560
                  8064
                  8100
                  8400
                  8640
                  9072
                  9450
                  9600
                  10080
                  10368
                  10800
                  11200
                  11340
                  11520
                  12096
                  12600
                  12960
                  13440
                  14400
                  15120
                  16200
                  16800
                  17280
                  18144
                  18900
                  19200
                  20160
                  21600
                  22400
                  22680
                  24192
                  25200
                  25920
                  26880
                  28800
                  30240
                  32400
                  33600
                  34560
                  36288
                  37800
                  40320
                  43200
                  45360
                  50400
                  51840
                  56700
                  57600
                  60480
                  64800
                  67200
                  72576
                  75600
                  80640
                  86400
                  90720
                  100800
                  103680
                  113400
                  120960
                  129600
                  134400
                  151200
                  172800
                  181440
                  201600
                  226800
                  241920
                  259200
                  302400
                  362880
                  403200
                  453600
                  518400
                  604800
                  725760
                  907200
                  1209600
                  1814400
                  3628800)
                "All possible products between numbers 1 to 10")
  ))